{% extends "base.html" %}
{% block head %}
	{{super()}}
	<script type="text/javascript">
		function confirmDel(id) {
			if(window.confirm("Are you sure you want to delete this post?")) {
				document.forms["deletepost"+id].submit();			
			}			
		}
	</script>
{% endblock %}
{% block content %}
	{% if user %}
		<form class="grid_12 content" style="margin: 20px 0 0 10px; padding: 0;" action="/newpost" method="GET">
			<button class="button" style="margin: 10px 0 0 10px;" id="submit">New Post</button>
		</form>
		<div class="clear"></div>
	{% endif %}
	{% for post in posts%}
		<div class="grid_12 blog-entry entry" style="margin-bottom: 0px;">
			<aside class="entry">
				<img style="float:left; width:100px; height:100px; margin-right: 10px;" src="{{gravatar(get_user(post.user).email, default='http://www.erhsroboticsclub.org/images/alien-head.jpg')}}" alt="Profile Picture of Blog Poster">
				{% if user %}
					{% if user.key().id() == post.user or user.isadmin %}
						<form method="POST" action="/deletepost" id="deletepost{{post.key().id()}}">
							<input type="hidden" name="post" value="{{post.key().id()}}" />
							<a class="remove-button" href="#" onclick="confirmDel({{post.key().id()}})"></a>			
						</form>
						<a class="edit-button" href="/editpost/{{post.key().id()}}"></a>
					{% endif %}
				{% endif %}
				<!--<div class="fb-like" data-href="http://facebook.erhs-team53.appspot.com/viewpost/{{post.key().id()}}" 
					 data-send="true" data-layout="button_count" data-width="450" data-show-faces="false" 
					 data-font="segoe ui" style="float:right; padding-right: 20px;">
				</div>-->
				<h2><a href="/viewpost/{{post.key().id()}}">{{post.subject}}</a></h2>
				<h3>Created by: {{post.username}}</h3>
				<h3>Date: {{calendar.month_name[post.created.month]}} {{post.created.day}}, {{post.created.year}}</h3>
			</aside>
			<div class="clear"></div>
			<section class="entry">
				<p>{{post.content}}</p>
				<hr>
			</section>
		</div><!-- /.blog-entry -->
	{% endfor %}
	<div class="grid_12 content" id="page-navigation">
		{% if hasPreviousPage %}
			<div class="grid_2 alpha">
			<a href="/blog/{{currentPage - 1}}">Previous Page</a>
			</div>
		{% endif %}
		{% if hasNextPage %}
			<div style="float:right; text-align:right;" class="grid_2 omega">
			<a href="/blog/{{currentPage + 1 }}">Next Page</a>
			</div>
		{% endif %}
	</div>
{% endblock %}
